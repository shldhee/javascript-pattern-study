## 5. 샌드박스 패턴

샌드박스 패턴은 네임스페이스 패턴의 다음과 같은 단점을 해결한다.

*   애플리케이션 전역 객체가 단 하나의 전역 변수에 의존한다. 따라서 네임스페이스 패턴으로는 동일한 애플리케이션이나 라이브러리의 두 가지 버전을 한 페이지에서 실행시키는 것이 불가능하다. (여러 버전들이 모두 `MYAPP`이라는 동일한 전역 변수명을 쓰기 떄문)
*   `MYAPP.utilities.array`와 같이 점으로 연결된 긴 이름을 써야 하고 런타임에는 탐색 작업을 거쳐야 한다.

샌드박스 패턴은 어떤 모듈이 다른 모듈과 그 모듈의 샌드박스에 영향을 미치지 않고 동작할 수 있는 환경을 제공한다.

### 5-1) 전역 생성자

네임스페이스 패턴에서는 전역 객체가 하나다.

샌드박스 패턴의 유일한 전역은 생성자다. 이것을 `Sandbox()`라고 하자. 이 생성자를 통해 객체들을 생성할 것이다.

그리고 이 생성자에 콜백 함수를 전달해 해당 코드를 샌드박스 내부 환경으로 격리 시킬것이다.

``` js
new Sandbox(function (box) {
  // code...
});
```

`box`객체는 네임스페이스 패턴에서의 `MYAPP`과 같은 것이다. 코드가 동작하는데 필요한 모든 라이브러리 기능들이 여기에 들어간다.

*   `new`를 강제하는 패턴을 활용하여 객체를 생성할 떄 `new`를 쓰지 않아도 되게 만든다.
*   `Sandbox()` 생성자가 선택적인 인자를 하나 이상 받을 수 있게 한다. 이 인자들은 객체를 생성하는 데 필요한 모듈의 이름을 지정한다. 우리는 코드의 모듈화를 지향하고 있으므로 `Sandbox()`가 제공하는 기능 대부분이 실제로는 모듈안에 담겨지게 될 것이다.

[new를 강제하는 패턴][3362e803]

  [3362e803]: https://github.com/shldhee/javascript-pattern-study/blob/master/02_literal_constructor/README.md#3-new를-강제하는-패턴 "3장"

객체를 초기화는 코드
`new`를 쓰지 않고 `ajax`와 `event`를 사용하는 객체를 만들 수 있다.

``` js
Sandbox(['ajax', 'event'], function (box) {
  // console.log(box);
});

위 예제와 비슷하지만 모듈 이름을 개별적인 인자로 전달

Sandbox('ajax', 'dom', function (box) {
  // console.log(box);
});
```

'쓸 수 있는 모듈을 모두 사용한다'는 의미로 와일드카드 `*` 인자를 사용하면 어떨까? 편의를 위해 모듈명을 누락시키면 샌드박스가 자동으로 `*` 를 가정하도록 하자.

``` js
Sandbox('*', function (box) {
  // console.log(box);
})
```
